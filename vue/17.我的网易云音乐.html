<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>云轻听音乐</title>
</head>
<style>
    body{
        position: absolute;
        margin: 0px auto;
        padding: 0px;
        font-size:0;
    }
    /* 背景模糊图片 */
    #mask{                                 
        width: 100px;
        height: 100px;
        filter: blur(30px);
    }
    img{
        
        width: 1900px;
        height: 1500px;
    }
    #background{
    position: relative;
    margin-top: 110px;
    margin-left: 414px;
    width: 1086px;
    height: 565px;
    background: inherit;
    background-color: inherit;
    background-color: rgba(204, 204, 204, 0.2);
    box-sizing: border-box;
    border-width: 1px;
    border-style: solid;
    border-color: #B7B7B7;
    border-radius: 50px;
    -moz-box-shadow: none;
    -webkit-box-shadow: none;
    box-shadow: none;
    -webkit-box-shadow: 0 0 25px 9px rgba(0,0,0,0.3) ;
    box-shadow: 0 0 25px 9px rgba(0,0,0,0.3) ;
    }
    #subjectmusic{
        margin-top: 50.5px;
        margin-left: 88px;
        width: 910px;
        height: 300px;
        background: white;
        filter: blur(27px);
    }
    #subjectmusic1{
        position: absolute;
        width: 910px;
        height: 300px;    
    }


    .musicpicture{
        width: 300px;
        height: 300px;
    }
    .musicpicture1{
        width: 300px;
        height: 300px;
        margin-left: 300px;
        margin-top: 0px;
    }


    #picture{
        position: absolute;
        width: 300px;
        height: 300px;
        border-radius: 0px 200px 200px 0px;
        z-index: 2;
    }

    #musicbody{
        position: absolute;
        top: 132.5px;
        left: 88px;
        width: 910px;
        height: 300px;
    }

    .musiclist{
        position: relative;
        margin-left: 300px;
        margin-top: -300px;
        width: 300px;
        height: 300px;
        overflow-x: hidden;
        overflow-y: hidden;
    }
    .musiclist1{                      /*改变滑轮样式*/
        position: relative;
        margin-left: 300px;
        margin-top: -300px;
        width: 300px;
        height: 300px;
        overflow: auto;
    }



    .musiccomment{               /*改变评论区的滚轮样式*/
        position: absolute;
        z-index: 3;
        margin-left: 600px;
        margin-top: -300px;
        width: 300px;
        height: 300px;
        overflow: hidden ; 
        
    }

    .musiccomment1{
        position: absolute;
        z-index: 3;
        margin-left: 600px;
        margin-top: -300px;
        width: 300px;
        height: 300px;
        overflow: auto;
    }



    input{
        width: 300px;
        height: 44px;
        -webkit-box-shadow: 5px 5px 5px 0 rgba(0,0,0,0.2) ;
        box-shadow: 5px 5px 5px 0 rgba(0,0,0,0.2) ;
        border: 3px solid #b7b7b7;
        -webkit-border-radius: 50px;
        border-radius: 50px;

    }
    button{
        width: 140px;
        height: 50px;
        border: 3px solid #B7B7B7;
        -webkit-border-radius: 60px;
        border-radius: 60px;
        -webkit-box-shadow: 5px 5px 5px 0 rgba(0,0,0,0.2) ;
        box-shadow: 5px 5px 5px 0 rgba(0,0,0,0.2) ;
    }
    #lookup{
        margin-left: 323px;
        margin-top: 35px;
    }
    .myaudio{
        margin-top: -3px;
        margin-left: 88px;
        width: 900px;
    }
    #list{
        width: 257px;
        height: 59px;
        border: 1px solid #8C8C8C;
        border-bottom: 4px solid rgba(140,140,140,1); 
        margin-left: 11.5px;
        margin-top: 5px;
        background: #FEFDFD;
        border-radius: 10px 10px 10px 10px ;
        -webkit-box-shadow: 5px 5px 10px 2px rgba(0,0,0,0.3) ;
        box-shadow: 5px 5px 10px 2px rgba(0,0,0,0.3) ;
        
    }
    #left{
        margin: 17px auto;
        width: 25px;
        height: 25px;
    }
    
   P{
        margin-left: 70px;
        font-size: 14px;
        margin-top:-39px ;
        width: 150px;
        height: 16px;
        overflow: hidden;
        font-family: "等线";
   }
   #right{
        margin-top: -35px;
        width: 25px;
        height: 25px;
        margin-left: 231px;
        float: right;
    }
    #loopmusicpicture{
        width: 36px;
        height: 36px;
        border-radius: 60px 60px 60px 60px;
    }
    #loop{
        position: absolute;
        z-index: 1;
        width: 36px;
        height: auto;
        margin: 6px 0px 0px 43px;
    }
    #looppicture{
        margin: 11px 0px 33px 0px;
    }
    #usercomment{
        width: 257px;
        height: auto;
        margin-left: 21.5px;
        margin-top: 5px;
        margin-bottom: 30px;
        border: 1px solid #8C8C8C;
        border-bottom: 4px solid rgba(140,140,140,1); 
        margin-left: 11.5px;
        margin-top: 5px;
        background: #FEFDFD;
        border-radius: 10px 10px 10px 10px ;
        -webkit-box-shadow: 5px 5px 10px 2px rgba(0,0,0,0.3) ;
        box-shadow: 5px 5px 10px 2px rgba(0,0,0,0.3) ;
    }
    #userpicture{
        width: 36px;
        height: 36px;
        border-radius: 60px 60px 60px 60px ;
        
    }
    #username{
        margin-top: -24px;
        margin-left: 50px;
        font-family: "等线";
    }
    li{
        font-size: 12px;
        font-family: "等线";
        margin-bottom: 20px;
    }
    #ship{
       position: absolute;
       top: 135px;
       left: 88px;
       z-index: 2;
    }
</style>
<body>
<div id="app">           <!--用来挂载vue框架-->


    <!-- 模糊的音乐背景 -->
    <div id="mask">                      
     <img v-bind:src="musicbackgroundb">
    </div>


    <!-- 主要的音乐背景 -->
<div id="background">

    
    <div id="ship" v-if="lookmv">
        <video v-bind:src="musicMv" controls autoplay height="300px" width="300px">
        </video>
    </div>


    <div id="lookup">
        <input type="text" v-model="musicname"> 
        <button v-on:click="Press">查找</button>
    </div>

    <div id="subjectmusic">             <!--音乐主体遮罩 -->
      <img id="subjectmusic1"  v-bind:src="musicbackgroundb">
    </div>



    <div id="musicbody">                 <!--获取的音乐封面-->
    <div v-bind:class="can">                                      <!--动态黑胶-->
        <img id="picture"  v-bind:src="musicbackgrounda"  v-show="lookpicture">
    </div>
    
    




    <div  v-on:mouseover="roll" v-on:mouseout="moveroll" v-bind:class="musiclistroll">      <!--歌曲界面鼠标移入事件和移出事件来显示滚轮-->

    
    <div id="loop">                                                       <!--每首歌的歌曲图片-->
       <div id="looppicture" v-for="mi in musicsrc">
          <img id="loopmusicpicture"  v-bind:src="mi">
       </div>
    </div>

    <div id="list" v-for="mi in musicnamearr" >                          <!--每条详细歌曲-->
    <img id="left"  src="素材/播放1.png" v-on:click="downmusic(mi.id)">
    <p>{{ mi.name }}</p>
    <img id="right" src="素材/视频播放.png" v-on:click="downMusicMv(mi.mvid)" v-if="mi.mvid!=0" >

    </div>
    </div>



    <div v-bind:class="musiccommentroll" v-on:mouseover="commentroll" v-on:mouseout="commentmove">                   <!--评论界面-->


     <div id="usercomment" v-for="con in usermusiccomment">                    <!--需要v-for循环的界面来渲染用户歌曲的评论-->
      <img id="userpicture"  v-bind:src="con.user.avatarUrl">
       <p id="username"> {{con.user.nickname}} </p>
       <ul>
        <li>
          {{con.content}}
        </li>
       </ul>
     </div>

     
    </div>
    </div>

    <audio v-if="lookmusic" ref='audio'  controls autoplay loop class="myaudio" v-bind:src="listmusic"></audio>

</div>
</div> 



     
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>

    <script>
        var can = new Vue({
            el:"#app",
            data:{
                musicname:"",                                     //获取你搜索的歌曲
                musicsrc:[],                                      //存放歌曲播放地址         
                musicnamearr:[],                                  //传递歌曲信息包含了歌曲的名字
                musicidarr:[],                                    //存放歌曲的每首歌的id
                usermusiccomment:[],                              //存放歌曲的评论以及用户的名称和头像
                listmusic:"",                                     //传递到audio的音乐播放地址使其可以播放音乐
                musicbackgrounda:"素材/黑胶唱片.png",              //刚开始封面的黑胶唱片
                musicbackgroundb:"素材/背景.jpeg",                 //白云蓝天的背景
                can:"musicpicture1",                              //改变黑胶唱片的位置
                musicMv:"",
                
                lookmusic:false,                                       //这里是隐藏播放进度条的
                lookmv:false,                                          //显示视频mv
                lookpicture:true,                                      //显示黑胶唱片

                musiclistroll:"musiclist",

                musiccommentroll:"musiccomment",
                
            },
            methods:{
               
                Press:function(){                                                                             //查找音乐的按钮
                    this.musicsrc=[];
                    this.musicnamearr=[];
                    this.musicidarr=[];
                    this.usermusiccomment=[];
                   
                    var that = this;
                    this.can = "musicpicture";                                         
                    axios.get('https://autumnfish.cn/search?keywords='+this.musicname).then                  //获取音乐的接口信息
                    (function(response){
                        var num = response;
                         that.musicnamearr = response.data.result.songs;                                     //给musicnamearr传递歌曲信息 
                         console.log(response.data.result.songs);
                         for(var i = 0 ; i<response.data.result.songs.length;i++){
                            that.musicidarr.push(response.data.result.songs[i].id);
                         }    
                         
                         for(var i = 0 ; i < num.data.result.songs.length ; i++){
                         axios.get("https://autumnfish.cn/song/detail?ids="+num.data.result.songs[i].id).then
                         (function(response){
                            // console.log(response.data.songs[0].al.picUrl);
                            that.musicsrc.push(response.data.songs[0].al.picUrl);
                            
                         }
                         ,
                         function(){

                         })
                        }     
                    }
                    ,
                    function(err){
                    });
                    this.musicname="";
                },

                downmusic:function(id){                                                                       //根据id获取播放地址的接口
                    var that = this;
                    axios.get("https://autumnfish.cn/song/url?id="+id).then                               
                    (function(response){
                         //console.log(response.data.data[0].url);
                         that.listmusic = response.data.data[0].url;
                    }
                    ,
                    function(){
                    });

                    axios.get("https://autumnfish.cn/song/detail?ids="+id).then                           //根据id获取音乐封面的接口
                    (function(response){
                        console.log(response.data.songs[0].al.picUrl);
                        that.musicbackgrounda = response.data.songs[0].al.picUrl;
                        that.musicbackgroundb = response.data.songs[0].al.picUrl;
                    }
                    ,
                    function(){

                    });

                    axios.get("https://autumnfish.cn/comment/hot?type=0&id="+id).then                     //获取歌曲的评论
                    (function(response){
                        //   console.log(response.data.hotComments);
                          that.usermusiccomment = response.data.hotComments;
                    }
                    ,
                    function(){

                    });

                    this.lookmv=false;
                    this.lookmusic=true;
                    this.lookpicture=true;

                },

                downMusicMv:function(mvid){
                    this.lookmusic=false;
                    this.lookmv=true;
                    this.lookpicture=false;
                    var that = this;
                    axios.get("https://autumnfish.cn/mv/url?id="+mvid).then                              //获取歌曲的视频
                    (function(response){
                        console.log(response);
                        that.musicMv = response.data.data.url;
                    }
                    ,
                    function(err){

                    })
                },

                roll:function(){         //这个是歌曲区的滑轮
                   this.musiclistroll="musiclist1";
                },
                
                moveroll:function(){
                    this.musiclistroll="musiclist";
                },
                commentroll:function(){
                    this.musiccommentroll="musiccomment1";
                },

                commentmove:function(){
                    this.musiccommentroll="musiccomment";
                }



               
                    
            }
            

        })
    </script>
</body>
</html>